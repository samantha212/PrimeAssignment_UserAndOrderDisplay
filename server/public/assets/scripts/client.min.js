var app=angular.module("orderApp",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/addresses",{templateUrl:"views/addresses.html",controller:"AddressesController"}).when("/orders",{templateUrl:"views/orders.html",controller:"OrdersController"}),b.html5Mode({enabled:!0,requireBase:!1})}]),app.controller("AddressesController",["$scope","getAddresses",function(a,b){}]),app.controller("OrdersController",["$scope","getOrders",function(a,b){}]),app.controller("mainController",["$scope","$http","getAddresses","getOrders",function(a,b,c,d){a.users=[];a.displayAddresses=[],a.getUserAddresses=c.getUserAddresses,a.data=c.data,a.orderData=d.orderData,a.getSpecificOrders=d.getSpecificOrders,angular.element(document).ready(function(){b.get("/users").then(function(b){a.users=b.data,console.log(a.users),c.createAddressesObject(),d.getOrders()})})}]),app.factory("getAddresses",["$http",function(a){var b={results:[]},c=function(){a.get("/getuseraddresses").then(function(a){allAddressArray=a.data})},d=function(a){for(var c=a,d=[],e=allAddressArray,f=0;f<e.length;f++){var g=e[f];g.user_id==c&&d.push(g)}b.results=d};return{createAddressesObject:c,getUserAddresses:d,data:b}}]),app.factory("getOrders",["$http",function(a){var b={results:[],dollarTotal:0},c=function(){a.get("/getuserorders").then(function(a){allOrdersArray=a.data,console.log(allOrdersArray)})},d=function(a,c,d){function e(a){var b=a,c=b.slice(0,2),d=a.slice(3,5),e=a.slice(6,10),f=e+"-"+c+"-"+d;return f}var f=a,g=[],h=allOrdersArray,i=e(c),j=e(d);console.log("start date",i),console.log("end date",j);for(var k=0;k<h.length;k++){var l=h[k];if(l.user_id==f){var m=l.order_date,n=m.slice(0,4),o=m.slice(5,7),p=m.slice(8,10),q=n+"-"+o+"-"+p;q>i&&j>q&&(console.log("short date",q),thisOrderTotal=l.amount,orderCost=parseFloat(l.amount),b.dollarTotal+=orderCost,console.log(b.dollarTotal),g.push(l))}}b.results=g};return{getOrders:c,getSpecificOrders:d,orderData:b}}]);